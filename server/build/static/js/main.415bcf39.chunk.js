(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{128:function(e,t){},148:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(75),s=a.n(c),l=(a(93),a(94),a(33)),o=a.n(l),u=a(160),i=a(76),m=a.n(i),f=function(e){return r.a.createElement("button",{className:[m.a.Btn,e.className].join(" "),onClick:e.onClick,type:e.type||"button"},e.children)},g=a(48),d=a(4),h=a(44),p=a.n(h),E=a(18),_=a.n(E),b=a(11),v=a(27),j=a.n(v),O=function(e){return r.a.createElement(b.b,{to:e.to,className:_.a.Usr},r.a.createElement("div",{className:_.a.UsrPic},e.online?r.a.createElement("div",{className:_.a.UsrPicOnline}):null,r.a.createElement("img",{src:j.a,alt:"",className:_.a.UsrPic})),r.a.createElement("p",{className:_.a.UsrName},e.name))},C=a(78),x=a.n(C).a.connect("http://127.0.0.1:4000"),y=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){x.on("userloggedin",(function(e){c(e)})),x.on("userloggedout",(function(e){c(e)}))}),[]),r.a.createElement("div",{className:p.a.Users},r.a.createElement("h2",{className:p.a.UsersTitle},"Users"),a.map((function(e){return r.a.createElement(O,{key:e.username,name:e.username,to:"/chat/".concat(e.username),online:e.online})})))},S=Object(n.createContext)({isDark:null,toggleTheme:function(){}}),N=function(e){var t=Object(n.useContext)(S),a=t.isDark,c=t.toggleTheme;return r.a.createElement("div",{className:o.a.Layout},r.a.createElement(u.a,{container:!0,spacing:0},r.a.createElement(u.a,{item:!0,xs:2,className:o.a.Right},r.a.createElement(y,null),r.a.createElement(f,{className:o.a.ThemeBtn,onClick:c},a?r.a.createElement(g.a,null):r.a.createElement(g.b,null)," ",r.a.createElement("p",null,"Dark Mode"))),r.a.createElement(u.a,{item:!0,xs:10},e.children)))},U=a(15),k=a(86),w=a(49),M=a.n(w),T=a(34),A=a.n(T),D=function(e){return r.a.createElement("div",{className:A.a.Header},r.a.createElement("img",{src:e.photo,alt:"",className:A.a.HeaderImg}),r.a.createElement("p",{className:A.a.HeaderName},e.name))},H=a(82),L=a.n(H),I=a(19),P=a.n(I),B=function(e){var t=new Date(e.createdAt),a="".concat(t.getHours(),":").concat(t.getMinutes()),n=e.msg.replace(/((\w+:\/\/\S+)|(\w+[.:]\w+\S+))[^\s,.]/gi,(function(e){return'<a target="_blank" rel="noopener noreferrer" href='.concat(e,">").concat(e,"</a>")}));return n=n.replace(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b/g,(function(e){return"<a href=".concat(e,">").concat(e,"</a>")})),r.a.createElement("div",{className:[P.a.Container,"recevied"===e.type?P.a.Recevied:"sent"===e.type?P.a.Sent:null].join(" ")},r.a.createElement("p",{className:P.a.Msg,dangerouslySetInnerHTML:{__html:n}}),r.a.createElement("p",{className:P.a.Date},a))},R=Object(n.createContext)({user:null,setUser:function(){}}),W=function(e){var t=Object(n.useRef)(null),a=Object(n.useContext)(R).user;return Object(n.useEffect)((function(){t.current.scrollTop=t.current.scrollHeight}),[e.msgs]),r.a.createElement("div",{className:L.a.Msgs,ref:t},e.msgs.map((function(e,t){return r.a.createElement(B,{key:"".concat(e.user,"-").concat(t),type:e.user===a.username?"sent":"recevied",createdAt:e.createdAt,msg:e.message})})))},Y=a(35),q=a.n(Y),J=a(161),Z=a(83),z=function(e){return r.a.createElement("div",{className:q.a.Send},r.a.createElement(J.a,{placeholder:"Type a message...",className:q.a.SendTextarea,value:e.msg,onChange:function(t){return e.setMsg(t.target.value)},onKeyDown:function(t){13!==t.keyCode||t.shiftKey||(t.preventDefault(),e.sendMsg())}}),r.a.createElement(f,{className:q.a.SendBtn,onClick:e.sendMsg},r.a.createElement(Z.a,null)))},F=function(){var e=Object(n.useContext)(R).user,t=Object(U.h)().username,a=Object(n.useState)(!1),c=Object(d.a)(a,2),s=c[0],l=c[1],o=Object(n.useState)(null),u=Object(d.a)(o,2),i=u[0],m=u[1],f=Object(n.useState)([]),g=Object(d.a)(f,2),h=g[0],p=g[1],E=Object(n.useState)(""),_=Object(d.a)(E,2),b=_[0],v=_[1];Object(n.useEffect)((function(){console.log("render")})),Object(n.useEffect)((function(){return l(!0),s&&(m(null),v(null),v("")),function(){return l(!1)}}),[t,s]),Object(n.useEffect)((function(){return s&&(t===e.username?m(r.a.createElement("h1",{className:M.a.Error},"You can't chat with yourself")):(x.emit("room",{curUser:e.username,chatWith:t}),x.on("getAllMsgs",(function(e){p(e)})))),function(){return l(!1)}}),[e,t,s]),Object(n.useEffect)((function(){x.on("sendmsg",(function(e){return p((function(t){return[].concat(Object(k.a)(t),[e])}))}))}),[]);return r.a.createElement("div",{className:M.a.Chat},r.a.createElement(D,{photo:j.a,name:t}),i||r.a.createElement(r.a.Fragment,null,r.a.createElement(W,{msgs:h}),r.a.createElement(z,{sendMsg:function(){if(""===b.trim())return v("");x.emit("sendmsg",{message:b,from:e.username,to:t}),v("")},msg:b,setMsg:v})))},K=a(31),Q=a.n(K),X=a(84),V=a.n(X),$=function(e){return r.a.createElement("input",{type:e.type||"text",placeholder:e.placeholder,className:[V.a.Input,e.className].join(" "),onChange:e.onChange,required:!0})},G=a(162),ee=a(23),te=a.n(ee),ae=a(50),ne=a(85),re=a.n(ne).a.create({baseURL:"http://127.0.0.1:4000/api/v1",withCredentials:!0}),ce=function(){var e=Object(n.useState)(null),t=Object(d.a)(e,2),a=t[0],r=t[1],c=Object(n.useContext)(R).setUser,s=Object(U.g)().push,l=Object(n.useCallback)((function(e){var t;c(e.data.data),t=e.data.data,x.emit("loggedIn",t),s("/")}),[c,s]);return{sendAuthReq:function(){var e=Object(ae.a)(te.a.mark((function e(t,a){var n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.post("/users/".concat(t),a);case 3:n=e.sent,l(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r(e.t0.response.data);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),error:a,getMe:Object(n.useCallback)(Object(ae.a)(te.a.mark((function e(){var t;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.get("/users/me");case 3:t=e.sent,l(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),r(!0),s("/login");case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),[s,l])}},se=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],u=l[1],i=ce(),m=i.sendAuthReq,g=i.error;Object(n.useEffect)((function(){console.log(g)}),[g]);return r.a.createElement(G.a,{maxWidth:"sm"},r.a.createElement("div",{className:Q.a.Auth},r.a.createElement("p",null,"Log in"),r.a.createElement($,{type:"email",placeholder:"Your E-mail",onChange:function(e){return c(e.target.value)}}),r.a.createElement($,{type:"password",placeholder:"Your Password",onChange:function(e){return u(e.target.value)}}),r.a.createElement(f,{onClick:function(){return m("/login",{email:a,password:o})}},"Submit"),r.a.createElement(b.b,{to:"/signup"},"Create a new account")))},le=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],u=l[1],i=Object(n.useState)(""),m=Object(d.a)(i,2),g=m[0],h=m[1],p=Object(n.useState)(""),E=Object(d.a)(p,2),_=E[0],v=E[1],j=ce(),O=j.sendAuthReq,C=j.error;Object(n.useEffect)((function(){console.log(C)}),[C]);return r.a.createElement(G.a,{maxWidth:"sm"},r.a.createElement("div",{className:Q.a.Auth},r.a.createElement("p",null,"Sign up"),r.a.createElement($,{type:"text",placeholder:"Your Name",onChange:function(e){return c(e.target.value)}}),r.a.createElement($,{type:"email",placeholder:"Your E-mail",onChange:function(e){return u(e.target.value)}}),r.a.createElement($,{type:"password",placeholder:"Your Password",onChange:function(e){return h(e.target.value)}}),r.a.createElement($,{type:"password",placeholder:"Confrim Your Password",onChange:function(e){return v(e.target.value)}}),r.a.createElement(f,{onClick:function(){return O("/signup",{username:a,email:o,password:g,passwordConfirm:_})}},"Submit"),r.a.createElement(b.b,{to:"/login"},"Login to your account")))};var oe=function(){var e=Object(n.useContext)(R).user,t=ce(),a=t.getMe,c=t.error,s=Object(n.useContext)(S).isDark;Object(n.useEffect)((function(){a()}),[a]);var l=r.a.createElement(N,null,r.a.createElement(U.d,null,r.a.createElement(U.b,{exact:!0,path:"/"},r.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("h1",null,"Select User"))),r.a.createElement(U.b,{path:"/chat/:username"},r.a.createElement(F,null))));return e||(l=r.a.createElement("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"}},c?r.a.createElement(U.d,null,r.a.createElement(U.b,{path:"/login"},r.a.createElement(se,null)),r.a.createElement(U.b,{path:"/signup"},r.a.createElement(le,null)),r.a.createElement(U.a,{to:"/"})):r.a.createElement("h1",null,"Loading..."))),r.a.createElement("div",{className:["App",s?"Dark":"Light"].join(" ")},l)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=function(e){var t=Object(n.useState)(null),a=Object(d.a)(t,2),c=a[0],s=a[1];return r.a.createElement(R.Provider,{value:{user:c,setUser:s}},e.children)},ie=function(e){var t=localStorage.getItem("isDark"),a=Object(n.useState)(!t||JSON.parse(t)),c=Object(d.a)(a,2),s=c[0],l=c[1];return r.a.createElement(S.Provider,{value:{isDark:s,toggleTheme:function(){return l((function(e){return localStorage.setItem("isDark",JSON.stringify(!e)),!e}))}}},e.children)},me=r.a.createElement(r.a.StrictMode,null,r.a.createElement(ue,null,r.a.createElement(ie,null,r.a.createElement(b.a,null,r.a.createElement(oe,null)))));s.a.render(me,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},18:function(e,t,a){e.exports={Usr:"User_Usr__2ONx8",UsrPic:"User_UsrPic__2gE94",UsrPicOnline:"User_UsrPicOnline__27DWs",UsrName:"User_UsrName__3IkUZ"}},19:function(e,t,a){e.exports={Container:"ChatMessage_Container__2Cnpz",Msg:"ChatMessage_Msg__kFxk5",Recevied:"ChatMessage_Recevied__1YT_Q",Sent:"ChatMessage_Sent__3tWZH",Date:"ChatMessage_Date__1qCTj"}},27:function(e,t,a){e.exports=a.p+"static/media/jeffrey_000.1dad94d1.png"},31:function(e,t,a){e.exports={Auth:"Auth_Auth__3aB5K"}},33:function(e,t,a){e.exports={Layout:"Layout_Layout__2ugx7",Right:"Layout_Right__1Quyd",Left:"Layout_Left__1TEt3",ThemeBtn:"Layout_ThemeBtn__1-Pzz"}},34:function(e,t,a){e.exports={Header:"Header_Header__2W_-S",HeaderImg:"Header_HeaderImg__XxUoO",HeaderName:"Header_HeaderName__1tDVR"}},35:function(e,t,a){e.exports={Send:"ChattingSend_Send__CJ-Ny",SendTextarea:"ChattingSend_SendTextarea__1lYt8",SendBtn:"ChattingSend_SendBtn__2L8xx"}},44:function(e,t,a){e.exports={Users:"Users_Users__209Fa",UsersTitle:"Users_UsersTitle__20rPy"}},49:function(e,t,a){e.exports={Chat:"Chatting_Chat__1i6W-",Error:"Chatting_Error__3Qj7P"}},76:function(e,t,a){e.exports={Btn:"Button_Btn__3vq0b"}},82:function(e,t,a){e.exports={Msgs:"ChattingMessages_Msgs__3X1xr"}},84:function(e,t,a){e.exports={Input:"Input_Input__cbq6C"}},88:function(e,t,a){e.exports=a(148)},93:function(e,t,a){},94:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.415bcf39.chunk.js.map