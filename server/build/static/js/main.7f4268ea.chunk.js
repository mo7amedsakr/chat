(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{113:function(e,t){},120:function(e,t,n){},121:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(74),r=n.n(a).a.connect("https://p-to-p-chat.herokuapp.com"),c=function(e){return r.emit("loggedIn",e)},s=n(1),o=n.n(s),l=n(75),u=n.n(l),i=(n(120),n(121),n(44)),m=n.n(i),d=n(155),f=n(76),p=n.n(f),h=function(e){return o.a.createElement("button",{className:[p.a.Btn,e.className].join(" "),onClick:e.onClick,type:e.type||null,disabled:e.disable},e.children)},g=n(49),E=n(9),v=n(45),b=n.n(v),_=n(19),j=n.n(_),O=n(7),w=n(31),C=n.n(w),x=function(e){return o.a.createElement(O.b,{to:e.to,className:j.a.Usr},o.a.createElement("div",{className:j.a.UsrPic},e.online?o.a.createElement("div",{className:j.a.UsrPicOnline}):null,o.a.createElement("img",{src:C.a,alt:"",className:j.a.UsrPic})),o.a.createElement("p",{className:j.a.UsrName},e.name))},y=function(){var e=Object(s.useState)([]),t=Object(E.a)(e,2),n=t[0],a=t[1];return Object(s.useEffect)((function(){r.on("userloggedin",(function(e){a(e)})),r.on("userloggedout",(function(e){a(e)}))}),[]),o.a.createElement("div",{className:b.a.Users},o.a.createElement("h2",{className:b.a.UsersTitle},"Users"),n.map((function(e){return o.a.createElement(x,{key:e.username,name:e.username,to:"/chat/".concat(e.username),online:e.online})})))},N=Object(s.createContext)({isDark:null,toggleTheme:function(){}}),S=function(e){var t=localStorage.getItem("isDark"),n=Object(s.useState)(!t||JSON.parse(t)),a=Object(E.a)(n,2),r=a[0],c=a[1];return o.a.createElement(N.Provider,{value:{isDark:r,toggleTheme:function(){return c((function(e){return localStorage.setItem("isDark",JSON.stringify(!e)),!e}))}}},e.children)},U=function(e){var t=Object(s.useContext)(N),n=t.isDark,a=t.toggleTheme;return o.a.createElement(d.a,{container:!0,spacing:0,style:{overflow:"hidden"}},o.a.createElement(d.a,{item:!0,xs:2,className:m.a.Right},o.a.createElement(y,null),o.a.createElement(h,{className:m.a.ThemeBtn,onClick:a},n?o.a.createElement(g.a,null):o.a.createElement(g.b,null)," ",o.a.createElement("p",null,"Dark Mode"))),o.a.createElement(d.a,{item:!0,xs:10},e.children))},k=n(158),A=n(4),R=n(80),L=n.n(R),M=n(36),P=n.n(M),T=function(){var e=Object(A.h)().username;return o.a.createElement("div",{className:P.a.Header},o.a.createElement("img",{src:C.a,alt:e,className:P.a.HeaderImg}),o.a.createElement("p",{className:P.a.HeaderName},e))},D=n(85),I=n(81),H=n.n(I),W=n(20),B=n.n(W),Y=function(e){var t=new Date(e.createdAt),n="".concat(t.getHours(),":").concat(t.getMinutes());return o.a.createElement("div",{className:[B.a.Container,"recevied"===e.type?B.a.Recevied:"sent"===e.type?B.a.Sent:null].join(" ")},o.a.createElement("p",{className:B.a.Msg},e.msg),o.a.createElement("p",{className:B.a.Date},n))},J=n(16),q=n.n(J),K=n(37),z=n(82),Z=n.n(z).a.create({baseURL:"https://p-to-p-chat.herokuapp.com/api/v1",withCredentials:!0}),G=Object(s.createContext)({error:null,setError:function(){}}),F=function(e){var t=Object(s.useState)(null),n=Object(E.a)(t,2),a=n[0],r=n[1];return o.a.createElement(G.Provider,{value:{error:a,setError:r}},e.children)},V=Object(s.createContext)({user:null,setUser:function(){},authLoading:!0,sendAuthReq:function(){var e=Object(K.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),$=function(e){var t=Object(s.useState)(null),n=Object(E.a)(t,2),a=n[0],r=n[1],l=Object(s.useState)(!0),u=Object(E.a)(l,2),i=u[0],m=u[1],d=Object(s.useContext)(G).setError,f=Object(A.g)().push,p=Object(s.useCallback)(Object(K.a)(q.a.mark((function e(){var t,n;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,Z.get("/users/me");case 4:t=e.sent,n=t.data.data,r(n),c(n),f("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),f("/login");case 14:m(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),[f]);Object(s.useEffect)((function(){p()}),[p]);var h=function(){var e=Object(K.a)(q.a.mark((function e(t,n){var a,s;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.username||""!==n.username.replace(/\s/g,"")){e.next=2;break}return e.abrupt("return",d({message:"Username not valid."}));case 2:if(o=n.email,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o.toLowerCase())&&!(n.password.length<8)){e.next=4;break}return e.abrupt("return",d({message:"Try again with a valid values."}));case 4:if(!n.passwordConfirm||n.passwordConfirm===n.password){e.next=6;break}return e.abrupt("return",d({message:"Passwords does not match."}));case 6:return m(!0),e.prev=7,e.next=10,Z.post("/users".concat(t),n);case 10:a=e.sent,s=a.data.data,r(s),c(s),f("/"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),d(e.t0.response.data);case 20:m(!1);case 21:case"end":return e.stop()}var o}),e,null,[[7,17]])})));return function(t,n){return e.apply(this,arguments)}}();return o.a.createElement(V.Provider,{value:{user:a,setUser:r,authLoading:i,sendAuthReq:h}},e.children)},Q=function(){var e=Object(s.useRef)(null),t=Object(s.useContext)(V).user,n=Object(A.h)().username,a=Object(s.useState)([]),c=Object(E.a)(a,2),l=c[0],u=c[1],i=Object(s.useState)(!0),m=Object(E.a)(i,2),d=m[0],f=m[1];return Object(s.useEffect)((function(){e.current.scrollTop=e.current.scrollHeight}),[l,d]),Object(s.useEffect)((function(){f(!0),r.emit("room",{curUser:t.username,chatWith:n}),r.on("getAllMsgs",(function(e){u(e),f(!1)}))}),[t,n]),Object(s.useEffect)((function(){r.on("sendmsg",(function(e){return u((function(t){return[].concat(Object(D.a)(t),[e])}))}))}),[]),o.a.createElement("div",{className:H.a.Msgs,ref:e},d?o.a.createElement("h1",null,"Loading..."):l.map((function(e,n){return o.a.createElement(Y,{key:"".concat(e.user,"-").concat(n),type:e.user===t.username?"sent":"recevied",createdAt:e.createdAt,msg:e.message})})))},X=n(38),ee=n.n(X),te=n(157),ne=n(83),ae=function(e){var t=Object(s.useContext)(V).user,n=Object(A.h)().username,a=Object(s.useRef)(null),c=function(){if(""===a.current.value.trim())return a.current.value="";r.emit("sendmsg",{message:a.current.value,from:t.username,to:n}),a.current.value=""};return o.a.createElement("div",{className:ee.a.Send},o.a.createElement(te.a,{placeholder:"Type a message...",className:ee.a.SendTextarea,ref:a,onKeyDown:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),c())}}),o.a.createElement(h,{className:ee.a.SendBtn,onClick:c},o.a.createElement(ne.a,null)))},re=function(){return o.a.createElement("div",{className:L.a.Chat},o.a.createElement(T,null),o.a.createElement(Q,null),o.a.createElement(ae,null))},ce=n(24),se=n.n(ce),oe=n(84),le=n.n(oe),ue=Object(s.forwardRef)((function(e,t){return o.a.createElement("input",{type:e.type||"text",placeholder:e.placeholder,className:[le.a.Input,e.className].join(" "),required:!0,ref:t})})),ie=function(){var e=Object(s.useContext)(V),t=e.sendAuthReq,n=e.authLoading,a=Object(s.useContext)(G).error,r=Object(s.useRef)(null),c=Object(s.useRef)(null);return o.a.createElement("form",{className:se.a.Auth,onSubmit:function(e){return e.preventDefault(),t("/login",{email:r.current.value,password:c.current.value})}},o.a.createElement("h2",null,"Log in"),a?o.a.createElement("p",{className:se.a.AuthError},a.message):null,o.a.createElement(ue,{type:"email",placeholder:"Your E-mail",ref:r}),o.a.createElement(ue,{type:"password",placeholder:"Your Password",ref:c}),o.a.createElement(h,null,n?"Loading...":"Submit"),o.a.createElement(O.b,{to:"/signup"},"Create new account"))},me=function(){var e=Object(s.useContext)(V),t=e.sendAuthReq,n=e.authLoading,a=Object(s.useContext)(G).error,r=Object(s.useRef)(null),c=Object(s.useRef)(null),l=Object(s.useRef)(null),u=Object(s.useRef)(null);return o.a.createElement("form",{className:se.a.Auth,onSubmit:function(e){return e.preventDefault(),t("/signup",{username:r.current.value,email:c.current.value,password:l.current.value,passwordConfirm:u.current.value})}},o.a.createElement("h2",null,"Sign up"),a?o.a.createElement("p",null,a.message):null,o.a.createElement(ue,{type:"text",placeholder:"Your Username",ref:r}),o.a.createElement(ue,{type:"email",placeholder:"Your E-mail",ref:c}),o.a.createElement(ue,{type:"password",placeholder:"Your Password",ref:l}),o.a.createElement(ue,{type:"password",placeholder:"Confirm Your Password",ref:u}),o.a.createElement(h,null,n?"Loading...":"Submit"),o.a.createElement(O.b,{to:"/login"},"Login to your account"))};var de=function(){var e=Object(s.useContext)(N).isDark,t=Object(s.useContext)(V),n=t.user,a=t.authLoading,r=o.a.createElement(U,null,o.a.createElement(A.d,null,o.a.createElement(A.b,{exact:!0,path:"/"},o.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},o.a.createElement("h1",null,"Select User"))),o.a.createElement(A.b,{path:"/chat/:username"},o.a.createElement(re,null)),o.a.createElement(A.a,{to:"/"})));return n||(r=o.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},o.a.createElement(k.a,{fixed:!0,maxWidth:"sm"},a?o.a.createElement("h1",{style:{textAlign:"center"}},"Loading..."):o.a.createElement(A.d,null,o.a.createElement(A.b,{path:"/login"},o.a.createElement(ie,null)),o.a.createElement(A.b,{path:"/signup"},o.a.createElement(me,null)),o.a.createElement(A.a,{to:"/login"}))))),o.a.createElement("div",{className:["App",e?"Dark":"Light"].join(" ")},r)},fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function pe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var he=o.a.createElement(o.a.StrictMode,null,o.a.createElement(O.a,null,o.a.createElement(F,null,o.a.createElement($,null,o.a.createElement(S,null,o.a.createElement(de,null))))));u.a.render(he,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");fe?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):pe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):pe(t,e)}))}}()},19:function(e,t,n){e.exports={Usr:"User_Usr__3MsOa",UsrPic:"User_UsrPic__109hm",UsrPicOnline:"User_UsrPicOnline__3nFIW",UsrName:"User_UsrName__yNN1i"}},20:function(e,t,n){e.exports={Container:"ChatMessage_Container__2IsQr",Msg:"ChatMessage_Msg__1U98C",Recevied:"ChatMessage_Recevied__1zSaq",Sent:"ChatMessage_Sent__Jfl94",Date:"ChatMessage_Date__2C6CW"}},24:function(e,t,n){e.exports={Auth:"Auth_Auth__28SGs",AuthError:"Auth_AuthError__3r9be"}},31:function(e,t,n){e.exports=n.p+"static/media/default.5881650b.jpg"},36:function(e,t,n){e.exports={Header:"Header_Header__2_ci0",HeaderImg:"Header_HeaderImg__YJ_cK",HeaderName:"Header_HeaderName__eYVeU"}},38:function(e,t,n){e.exports={Send:"ChattingSend_Send__1ztL_",SendTextarea:"ChattingSend_SendTextarea__1G_f3",SendBtn:"ChattingSend_SendBtn__Zjerc"}},44:function(e,t,n){e.exports={Right:"Layout_Right__2hNw0",Left:"Layout_Left__1eF2e",ThemeBtn:"Layout_ThemeBtn__oe5wA"}},45:function(e,t,n){e.exports={Users:"Users_Users__3Kw6G",UsersTitle:"Users_UsersTitle__1ioh4"}},76:function(e,t,n){e.exports={Btn:"Button_Btn__22W31"}},80:function(e,t,n){e.exports={Chat:"Chatting_Chat__KlwHr",Error:"Chatting_Error__3VsbA"}},81:function(e,t,n){e.exports={Msgs:"ChattingMessages_Msgs__h3PUO"}},84:function(e,t,n){e.exports={Input:"Input_Input__3nJZI"}},87:function(e,t,n){e.exports=n(143)}},[[87,1,2]]]);
//# sourceMappingURL=main.7f4268ea.chunk.js.map