(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{123:function(e,t){},143:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(74),s=n.n(c),l=(n(92),n(93),n(44)),o=n.n(l),u=n(155),i=n(75),m=n.n(i),f=function(e){return r.a.createElement("button",{className:[m.a.Btn,e.className].join(" "),onClick:e.onClick,type:e.type||null,disabled:e.disable},e.children)},d=n(49),p=n(9),h=n(45),g=n.n(h),E=n(19),v=n.n(E),b=n(7),_=n(31),j=n.n(_),O=function(e){return r.a.createElement(b.b,{to:e.to,className:v.a.Usr},r.a.createElement("div",{className:v.a.UsrPic},e.online?r.a.createElement("div",{className:v.a.UsrPicOnline}):null,r.a.createElement("img",{src:j.a,alt:"",className:v.a.UsrPic})),r.a.createElement("p",{className:v.a.UsrName},e.name))},w=n(76),C=n.n(w).a.connect("https://p-to-p-chat.herokuapp.com"),x=function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=!0;return C.on("usersChanged",(function(t){e&&c(t)})),function(){e=!1}}),[]),r.a.createElement("div",{className:g.a.Users},r.a.createElement("h2",{className:g.a.UsersTitle},"Users"),n.map((function(e){return r.a.createElement(O,{key:e.username,name:e.username,to:"/chat/".concat(e.username),online:e.online})})))},y=Object(a.createContext)({isDark:null,toggleTheme:function(){}}),N=function(e){var t=localStorage.getItem("isDark"),n=Object(a.useState)(!t||JSON.parse(t)),c=Object(p.a)(n,2),s=c[0],l=c[1];return r.a.createElement(y.Provider,{value:{isDark:s,toggleTheme:function(){return l((function(e){return localStorage.setItem("isDark",JSON.stringify(!e)),!e}))}}},e.children)},S=function(e){var t=Object(a.useContext)(y),n=t.isDark,c=t.toggleTheme;return r.a.createElement(u.a,{container:!0,spacing:0,style:{overflow:"hidden"}},r.a.createElement(u.a,{item:!0,xs:2,className:o.a.Right},r.a.createElement(x,null),r.a.createElement(f,{className:o.a.ThemeBtn,onClick:c},n?r.a.createElement(d.a,null):r.a.createElement(d.b,null)," ",r.a.createElement("p",null,"Dark Mode"))),r.a.createElement(u.a,{item:!0,xs:10},e.children))},U=n(158),k=n(4),A=n(80),R=n.n(A),L=n(36),M=n.n(L),P=function(){var e=Object(k.h)().username;return r.a.createElement("div",{className:M.a.Header},r.a.createElement("img",{src:j.a,alt:e,className:M.a.HeaderImg}),r.a.createElement("p",{className:M.a.HeaderName},e))},T=n(85),D=n(81),I=n.n(D),H=n(20),W=n.n(H),B=function(e){var t=new Date(e.createdAt),n="".concat(t.getHours(),":").concat(t.getMinutes());return r.a.createElement("div",{className:[W.a.Container,"recevied"===e.type?W.a.Recevied:"sent"===e.type?W.a.Sent:null].join(" ")},r.a.createElement("p",{className:W.a.Msg},e.msg),r.a.createElement("p",{className:W.a.Date},n))},Y=n(16),J=n.n(Y),q=n(37),V=n(82),K=n.n(V).a.create({baseURL:"https://p-to-p-chat.herokuapp.com/api/v1",withCredentials:!0}),z=Object(a.createContext)({error:null,setError:function(){}}),Z=function(e){var t=Object(a.useState)(null),n=Object(p.a)(t,2),c=n[0],s=n[1];return r.a.createElement(z.Provider,{value:{error:c,setError:s}},e.children)},G=Object(a.createContext)({user:null,setUser:function(){},authLoading:!0,sendAuthReq:function(){var e=Object(q.a)(J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),F=function(e){C.emit("loggedIn",e)},$=function(e){var t=Object(a.useState)(null),n=Object(p.a)(t,2),c=n[0],s=n[1],l=Object(a.useState)(!0),o=Object(p.a)(l,2),u=o[0],i=o[1],m=Object(a.useContext)(z).setError,f=Object(k.g)().push,d=Object(a.useCallback)(Object(q.a)(J.a.mark((function e(){var t,n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.prev=1,e.next=4,K.get("/users/me");case 4:t=e.sent,n=t.data.data,s(n),F(n),f("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),f("/login");case 14:i(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),[f]);Object(a.useEffect)((function(){d()}),[d]);var h=function(){var e=Object(q.a)(J.a.mark((function e(t,n){var a,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.username||""!==n.username.replace(/\s/g,"")){e.next=2;break}return e.abrupt("return",m({message:"Username not valid."}));case 2:if(c=n.email,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c.toLowerCase())&&!(n.password.length<8)){e.next=4;break}return e.abrupt("return",m({message:"Try again with a valid values."}));case 4:if(!n.passwordConfirm||n.passwordConfirm===n.password){e.next=6;break}return e.abrupt("return",m({message:"Passwords does not match."}));case 6:return i(!0),e.prev=7,e.next=10,K.post("/users".concat(t),n);case 10:a=e.sent,r=a.data.data,s(r),F(r),f("/"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),m(e.t0.response.data);case 20:i(!1);case 21:case"end":return e.stop()}var c}),e,null,[[7,17]])})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement(G.Provider,{value:{user:c,setUser:s,authLoading:u,sendAuthReq:h}},e.children)},Q=function(){var e=Object(a.useRef)(null),t=Object(a.useContext)(G).user,n=Object(k.h)().username,c=Object(a.useState)([]),s=Object(p.a)(c,2),l=s[0],o=s[1],u=Object(a.useState)(!0),i=Object(p.a)(u,2),m=i[0],f=i[1];return Object(a.useEffect)((function(){e.current.scrollTop=e.current.scrollHeight}),[l,m]),Object(a.useEffect)((function(){C.emit("joinRoom",{curUser:t.username,chatWith:n})}),[t,n]),Object(a.useEffect)((function(){var e=!0;return f(!0),C.on("allMsgs",(function(t){e&&(o(t),f(!1))})),function(){e=!1}}),[]),Object(a.useEffect)((function(){var e=!0;return C.on("sendMsg",(function(t){e&&o((function(e){return[].concat(Object(T.a)(e),[t])}))})),function(){e=!1}}),[]),r.a.createElement("div",{className:I.a.Msgs,ref:e},m?r.a.createElement("h1",null,"Loading..."):l.map((function(e,n){return r.a.createElement(B,{key:"".concat(e.user,"-").concat(n),type:e.user===t.username?"sent":"recevied",createdAt:e.createdAt,msg:e.message})})))},X=n(38),ee=n.n(X),te=n(157),ne=n(83),ae=function(e){var t=Object(a.useContext)(G).user,n=Object(k.h)().username,c=Object(a.useRef)(null),s=function(){var e=c.current.value;c.current.value="",""!==e.replace(/\s/g,"")&&C.emit("sendMsg",{message:e,from:t.username,to:n})};return r.a.createElement("div",{className:ee.a.Send},r.a.createElement(te.a,{placeholder:"Type a message...",className:ee.a.SendTextarea,ref:c,onKeyDown:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),s())}}),r.a.createElement(f,{className:ee.a.SendBtn,onClick:s},r.a.createElement(ne.a,null)))},re=function(){return r.a.createElement("div",{className:R.a.Chat},r.a.createElement(P,null),r.a.createElement(Q,null),r.a.createElement(ae,null))},ce=n(24),se=n.n(ce),le=n(84),oe=n.n(le),ue=Object(a.forwardRef)((function(e,t){return r.a.createElement("input",{type:e.type||"text",placeholder:e.placeholder,className:[oe.a.Input,e.className].join(" "),required:!0,ref:t,defaultValue:e.defaultValue})})),ie=function(){var e=Object(a.useContext)(G),t=e.sendAuthReq,n=e.authLoading,c=Object(a.useContext)(z).error,s=Object(a.useRef)(null),l=Object(a.useRef)(null);return r.a.createElement("form",{className:se.a.Auth,onSubmit:function(e){return e.preventDefault(),t("/login",{email:s.current.value,password:l.current.value})}},r.a.createElement("h2",null,"Log in"),c?r.a.createElement("p",{className:se.a.AuthError},c.message):null,r.a.createElement(ue,{type:"email",placeholder:"Your E-mail",ref:s,defaultValue:"test@user.com"}),r.a.createElement(ue,{type:"password",placeholder:"Your Password",ref:l,defaultValue:"testuser1234"}),r.a.createElement(f,null,n?"Loading...":"Submit"),r.a.createElement(b.b,{to:"/signup"},"Create new account"))},me=function(){var e=Object(a.useContext)(G),t=e.sendAuthReq,n=e.authLoading,c=Object(a.useContext)(z).error,s=Object(a.useRef)(null),l=Object(a.useRef)(null),o=Object(a.useRef)(null),u=Object(a.useRef)(null);return r.a.createElement("form",{className:se.a.Auth,onSubmit:function(e){return e.preventDefault(),t("/signup",{username:s.current.value,email:l.current.value,password:o.current.value,passwordConfirm:u.current.value})}},r.a.createElement("h2",null,"Sign up"),c?r.a.createElement("p",null,c.message):null,r.a.createElement(ue,{type:"text",placeholder:"Your Username",ref:s}),r.a.createElement(ue,{type:"email",placeholder:"Your E-mail",ref:l}),r.a.createElement(ue,{type:"password",placeholder:"Your Password",ref:o}),r.a.createElement(ue,{type:"password",placeholder:"Confirm Your Password",ref:u}),r.a.createElement(f,null,n?"Loading...":"Submit"),r.a.createElement(b.b,{to:"/login"},"Login to your account"))};var fe=function(){var e=Object(a.useContext)(y).isDark,t=Object(a.useContext)(G),n=t.user,c=t.authLoading,s=r.a.createElement(S,null,r.a.createElement(k.d,null,r.a.createElement(k.b,{exact:!0,path:"/"},r.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("h1",null,"Select User"))),r.a.createElement(k.b,{path:"/chat/:username"},r.a.createElement(re,null)),r.a.createElement(k.a,{to:"/"})));return n||(s=r.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(U.a,{fixed:!0,maxWidth:"sm"},c?r.a.createElement("h1",{style:{textAlign:"center"}},"Loading..."):r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/login"},r.a.createElement(ie,null)),r.a.createElement(k.b,{path:"/signup"},r.a.createElement(me,null)),r.a.createElement(k.a,{to:"/login"}))))),r.a.createElement("div",{className:["App",e?"Dark":"Light"].join(" ")},s)},de=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function pe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var he=r.a.createElement(r.a.StrictMode,null,r.a.createElement(b.a,null,r.a.createElement(Z,null,r.a.createElement($,null,r.a.createElement(N,null,r.a.createElement(fe,null))))));s.a.render(he,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");de?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):pe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):pe(t,e)}))}}()},19:function(e,t,n){e.exports={Usr:"User_Usr__3MsOa",UsrPic:"User_UsrPic__109hm",UsrPicOnline:"User_UsrPicOnline__3nFIW",UsrName:"User_UsrName__yNN1i"}},20:function(e,t,n){e.exports={Container:"ChatMessage_Container__2IsQr",Msg:"ChatMessage_Msg__1U98C",Recevied:"ChatMessage_Recevied__1zSaq",Sent:"ChatMessage_Sent__Jfl94",Date:"ChatMessage_Date__2C6CW"}},24:function(e,t,n){e.exports={Auth:"Auth_Auth__28SGs",AuthError:"Auth_AuthError__3r9be"}},31:function(e,t,n){e.exports=n.p+"static/media/default.5881650b.jpg"},36:function(e,t,n){e.exports={Header:"Header_Header__2_ci0",HeaderImg:"Header_HeaderImg__YJ_cK",HeaderName:"Header_HeaderName__eYVeU"}},38:function(e,t,n){e.exports={Send:"ChattingSend_Send__1ztL_",SendTextarea:"ChattingSend_SendTextarea__1G_f3",SendBtn:"ChattingSend_SendBtn__Zjerc"}},44:function(e,t,n){e.exports={Right:"Layout_Right__2hNw0",Left:"Layout_Left__1eF2e",ThemeBtn:"Layout_ThemeBtn__oe5wA"}},45:function(e,t,n){e.exports={Users:"Users_Users__3Kw6G",UsersTitle:"Users_UsersTitle__1ioh4"}},75:function(e,t,n){e.exports={Btn:"Button_Btn__22W31"}},80:function(e,t,n){e.exports={Chat:"Chatting_Chat__KlwHr",Error:"Chatting_Error__3VsbA"}},81:function(e,t,n){e.exports={Msgs:"ChattingMessages_Msgs__h3PUO"}},84:function(e,t,n){e.exports={Input:"Input_Input__3nJZI"}},87:function(e,t,n){e.exports=n(143)},92:function(e,t,n){},93:function(e,t,n){}},[[87,1,2]]]);
//# sourceMappingURL=main.9fa680d7.chunk.js.map