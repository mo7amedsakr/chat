(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{123:function(e,t){},143:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(74),s=a.n(c),l=(a(92),a(93),a(44)),o=a.n(l),u=a(155),i=a(75),m=a.n(i),d=function(e){return r.a.createElement("button",{className:[m.a.Btn,e.className].join(" "),onClick:e.onClick,type:e.type||null,disabled:e.disable},e.children)},f=a(49),h=a(9),p=a(45),g=a.n(p),E=a(19),v=a.n(E),b=a(7),_=a(31),j=a.n(_),O=function(e){return r.a.createElement(b.b,{to:e.to,className:v.a.Usr},r.a.createElement("div",{className:v.a.UsrPic},e.online?r.a.createElement("div",{className:v.a.UsrPicOnline}):null,r.a.createElement("img",{src:j.a,alt:"",className:v.a.UsrPic})),r.a.createElement("p",{className:v.a.UsrName},e.name))},w=a(76),C=a.n(w).a.connect("https://p-to-p-chat.herokuapp.com"),x=function(){var e=Object(n.useState)([]),t=Object(h.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=!0;return C.on("usersChanged",(function(t){e&&c(t)})),function(){e=!1}}),[]),r.a.createElement("div",{className:g.a.Users},r.a.createElement("h2",{className:g.a.UsersTitle},"Users"),a.map((function(e){return r.a.createElement(O,{key:e.username,name:e.username,to:"/chat/".concat(e.username),online:e.online})})))},y=Object(n.createContext)({isDark:null,toggleTheme:function(){}}),N=function(e){var t=localStorage.getItem("isDark"),a=Object(n.useState)(!t||JSON.parse(t)),c=Object(h.a)(a,2),s=c[0],l=c[1];return r.a.createElement(y.Provider,{value:{isDark:s,toggleTheme:function(){return l((function(e){return localStorage.setItem("isDark",JSON.stringify(!e)),!e}))}}},e.children)},S=function(e){var t=Object(n.useContext)(y),a=t.isDark,c=t.toggleTheme;return r.a.createElement(u.a,{container:!0,spacing:0,style:{overflow:"hidden"}},r.a.createElement(u.a,{item:!0,xs:2,className:o.a.Right},r.a.createElement(x,null),r.a.createElement(d,{className:o.a.ThemeBtn,onClick:c},a?r.a.createElement(f.a,null):r.a.createElement(f.b,null)," ",r.a.createElement("p",null,"Dark Mode"))),r.a.createElement(u.a,{item:!0,xs:10},e.children))},U=a(158),k=a(4),A=a(80),R=a.n(A),L=a(36),M=a.n(L),P=function(){var e=Object(k.h)().username;return r.a.createElement("div",{className:M.a.Header},r.a.createElement("img",{src:j.a,alt:e,className:M.a.HeaderImg}),r.a.createElement("p",{className:M.a.HeaderName},e))},T=a(85),D=a(81),I=a.n(D),H=a(20),W=a.n(H),B=function(e){var t=new Date(e.createdAt),a="".concat(t.getHours(),":").concat(t.getMinutes());return r.a.createElement("div",{className:[W.a.Container,"recevied"===e.type?W.a.Recevied:"sent"===e.type?W.a.Sent:null].join(" ")},r.a.createElement("p",{className:W.a.Msg},e.msg),r.a.createElement("p",{className:W.a.Date},a))},Y=a(16),J=a.n(Y),q=a(37),V=a(82),K=a.n(V).a.create({baseURL:"/api/v1",withCredentials:!0}),z=Object(n.createContext)({error:null,setError:function(){}}),Z=function(e){var t=Object(n.useState)(null),a=Object(h.a)(t,2),c=a[0],s=a[1];return r.a.createElement(z.Provider,{value:{error:c,setError:s}},e.children)},G=Object(n.createContext)({user:null,setUser:function(){},authLoading:!0,sendAuthReq:function(){var e=Object(q.a)(J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),F=function(e){C.emit("loggedIn",e)},$=function(e){var t=Object(n.useState)(null),a=Object(h.a)(t,2),c=a[0],s=a[1],l=Object(n.useState)(!0),o=Object(h.a)(l,2),u=o[0],i=o[1],m=Object(n.useContext)(z).setError,d=Object(k.g)().push,f=Object(n.useCallback)(Object(q.a)(J.a.mark((function e(){var t,a;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.prev=1,e.next=4,K.get("/users/me");case 4:t=e.sent,a=t.data.data,s(a),F(a),d("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),d("/login");case 14:i(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),[d]);Object(n.useEffect)((function(){f()}),[f]);var p=function(){var e=Object(q.a)(J.a.mark((function e(t,a){var n,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.username||""!==a.username.replace(/\s/g,"")){e.next=2;break}return e.abrupt("return",m({message:"Username not valid."}));case 2:if(c=a.email,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c.toLowerCase())&&!(a.password.length<8)){e.next=4;break}return e.abrupt("return",m({message:"Try again with a valid values."}));case 4:if(!a.passwordConfirm||a.passwordConfirm===a.password){e.next=6;break}return e.abrupt("return",m({message:"Passwords does not match."}));case 6:return i(!0),e.prev=7,e.next=10,K.post("/users".concat(t),a);case 10:n=e.sent,r=n.data.data,s(r),F(r),d("/"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),m(e.t0.response.data);case 20:i(!1);case 21:case"end":return e.stop()}var c}),e,null,[[7,17]])})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(G.Provider,{value:{user:c,setUser:s,authLoading:u,sendAuthReq:p}},e.children)},Q=function(){var e=Object(n.useRef)(null),t=Object(n.useContext)(G).user,a=Object(k.h)().username,c=Object(n.useState)([]),s=Object(h.a)(c,2),l=s[0],o=s[1],u=Object(n.useState)(!0),i=Object(h.a)(u,2),m=i[0],d=i[1];return Object(n.useEffect)((function(){e.current.scrollTop=e.current.scrollHeight}),[l,m]),Object(n.useEffect)((function(){d(!0),C.emit("joinRoom",{curUser:t.username,chatWith:a})}),[t,a]),Object(n.useEffect)((function(){var e=!0;return C.on("allMsgs",(function(t){e&&(o(t),d(!1))})),C.on("sendMsg",(function(t){e&&o((function(e){return[].concat(Object(T.a)(e),[t])}))})),function(){e=!1}}),[]),r.a.createElement("div",{className:I.a.Msgs,ref:e},m?r.a.createElement("h1",null,"Loading..."):l.map((function(e,a){return r.a.createElement(B,{key:"".concat(e.user,"-").concat(a),type:e.user===t.username?"sent":"recevied",createdAt:e.createdAt,msg:e.message})})))},X=a(38),ee=a.n(X),te=a(157),ae=a(83),ne=function(e){var t=Object(n.useContext)(G).user,a=Object(k.h)().username,c=Object(n.useRef)(null),s=function(){var e=c.current.value;c.current.value="",""!==e.replace(/\s/g,"")&&C.emit("sendMsg",{message:e,from:t.username,to:a})};return r.a.createElement("div",{className:ee.a.Send},r.a.createElement(te.a,{placeholder:"Type a message...",className:ee.a.SendTextarea,ref:c,onKeyDown:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),s())}}),r.a.createElement(d,{className:ee.a.SendBtn,onClick:s},r.a.createElement(ae.a,null)))},re=function(){return r.a.createElement("div",{className:R.a.Chat},r.a.createElement(P,null),r.a.createElement(Q,null),r.a.createElement(ne,null))},ce=a(24),se=a.n(ce),le=a(84),oe=a.n(le),ue=Object(n.forwardRef)((function(e,t){return r.a.createElement("input",{type:e.type||"text",placeholder:e.placeholder,className:[oe.a.Input,e.className].join(" "),required:!0,ref:t,defaultValue:e.defaultValue})})),ie=function(){var e=Object(n.useContext)(G),t=e.sendAuthReq,a=e.authLoading,c=Object(n.useContext)(z).error,s=Object(n.useRef)(null),l=Object(n.useRef)(null);return r.a.createElement("form",{className:se.a.Auth,onSubmit:function(e){return e.preventDefault(),t("/login",{email:s.current.value,password:l.current.value})}},r.a.createElement("h2",null,"Log in"),c?r.a.createElement("p",{className:se.a.AuthError},c.message):null,r.a.createElement(ue,{type:"email",placeholder:"Your E-mail",ref:s,defaultValue:"test@user.com"}),r.a.createElement(ue,{type:"password",placeholder:"Your Password",ref:l,defaultValue:"testuser1234"}),r.a.createElement(d,null,a?"Loading...":"Submit"),r.a.createElement(b.b,{to:"/signup"},"Create new account"))},me=function(){var e=Object(n.useContext)(G),t=e.sendAuthReq,a=e.authLoading,c=Object(n.useContext)(z).error,s=Object(n.useRef)(null),l=Object(n.useRef)(null),o=Object(n.useRef)(null),u=Object(n.useRef)(null);return r.a.createElement("form",{className:se.a.Auth,onSubmit:function(e){return e.preventDefault(),t("/signup",{username:s.current.value,email:l.current.value,password:o.current.value,passwordConfirm:u.current.value})}},r.a.createElement("h2",null,"Sign up"),c?r.a.createElement("p",null,c.message):null,r.a.createElement(ue,{type:"text",placeholder:"Your Username",ref:s}),r.a.createElement(ue,{type:"email",placeholder:"Your E-mail",ref:l}),r.a.createElement(ue,{type:"password",placeholder:"Your Password",ref:o}),r.a.createElement(ue,{type:"password",placeholder:"Confirm Your Password",ref:u}),r.a.createElement(d,null,a?"Loading...":"Submit"),r.a.createElement(b.b,{to:"/login"},"Login to your account"))};var de=function(){var e=Object(n.useContext)(y).isDark,t=Object(n.useContext)(G),a=t.user,c=t.authLoading,s=r.a.createElement(S,null,r.a.createElement(k.d,null,r.a.createElement(k.b,{exact:!0,path:"/"},r.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("h1",null,"Select User"))),r.a.createElement(k.b,{path:"/chat/:username"},r.a.createElement(re,null)),r.a.createElement(k.a,{to:"/"})));return a||(s=r.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(U.a,{fixed:!0,maxWidth:"sm"},c?r.a.createElement("h1",{style:{textAlign:"center"}},"Loading..."):r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/login"},r.a.createElement(ie,null)),r.a.createElement(k.b,{path:"/signup"},r.a.createElement(me,null)),r.a.createElement(k.a,{to:"/login"}))))),r.a.createElement("div",{className:["App",e?"Dark":"Light"].join(" ")},s)},fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function he(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var pe=r.a.createElement(r.a.StrictMode,null,r.a.createElement(b.a,null,r.a.createElement(Z,null,r.a.createElement($,null,r.a.createElement(N,null,r.a.createElement(de,null))))));s.a.render(pe,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");fe?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):he(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):he(t,e)}))}}()},19:function(e,t,a){e.exports={Usr:"User_Usr__3MsOa",UsrPic:"User_UsrPic__109hm",UsrPicOnline:"User_UsrPicOnline__3nFIW",UsrName:"User_UsrName__yNN1i"}},20:function(e,t,a){e.exports={Container:"ChatMessage_Container__2IsQr",Msg:"ChatMessage_Msg__1U98C",Recevied:"ChatMessage_Recevied__1zSaq",Sent:"ChatMessage_Sent__Jfl94",Date:"ChatMessage_Date__2C6CW"}},24:function(e,t,a){e.exports={Auth:"Auth_Auth__28SGs",AuthError:"Auth_AuthError__3r9be"}},31:function(e,t,a){e.exports=a.p+"static/media/default.5881650b.jpg"},36:function(e,t,a){e.exports={Header:"Header_Header__2_ci0",HeaderImg:"Header_HeaderImg__YJ_cK",HeaderName:"Header_HeaderName__eYVeU"}},38:function(e,t,a){e.exports={Send:"ChattingSend_Send__1ztL_",SendTextarea:"ChattingSend_SendTextarea__1G_f3",SendBtn:"ChattingSend_SendBtn__Zjerc"}},44:function(e,t,a){e.exports={Right:"Layout_Right__2hNw0",Left:"Layout_Left__1eF2e",ThemeBtn:"Layout_ThemeBtn__oe5wA"}},45:function(e,t,a){e.exports={Users:"Users_Users__3Kw6G",UsersTitle:"Users_UsersTitle__1ioh4"}},75:function(e,t,a){e.exports={Btn:"Button_Btn__22W31"}},80:function(e,t,a){e.exports={Chat:"Chatting_Chat__KlwHr",Error:"Chatting_Error__3VsbA"}},81:function(e,t,a){e.exports={Msgs:"ChattingMessages_Msgs__h3PUO"}},84:function(e,t,a){e.exports={Input:"Input_Input__3nJZI"}},87:function(e,t,a){e.exports=a(143)},92:function(e,t,a){},93:function(e,t,a){}},[[87,1,2]]]);
//# sourceMappingURL=main.29db48e4.chunk.js.map